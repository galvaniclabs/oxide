<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 860 600">
  <!-- Background -->
  <rect width="860" height="600" rx="12" fill="#0a0f1a"/>

  <!-- ══════════ Layer 1: TUI Frontend ══════════ -->
  <rect x="30" y="20" width="800" height="140" rx="8" fill="#142240" stroke="#3b82f6" stroke-width="1"/>
  <text x="430" y="47" text-anchor="middle" fill="#f8fafc" font-family="sans-serif" font-size="15" font-weight="bold">TUI Frontend</text>
  <text x="430" y="65" text-anchor="middle" fill="#60a5fa" font-family="sans-serif" font-size="11">Rust — ratatui + crossterm</text>

  <!-- Row 1 -->
  <rect x="50" y="80" width="175" height="28" rx="14" fill="#1a2d50"/>
  <text x="137" y="99" text-anchor="middle" fill="#cbd5e1" font-family="sans-serif" font-size="11">Editor</text>
  <rect x="240" y="80" width="175" height="28" rx="14" fill="#1a2d50"/>
  <text x="327" y="99" text-anchor="middle" fill="#cbd5e1" font-family="sans-serif" font-size="11">File Tree</text>
  <rect x="430" y="80" width="175" height="28" rx="14" fill="#1a2d50"/>
  <text x="517" y="99" text-anchor="middle" fill="#cbd5e1" font-family="sans-serif" font-size="11">Terminal</text>
  <rect x="620" y="80" width="175" height="28" rx="14" fill="#1a2d50"/>
  <text x="707" y="99" text-anchor="middle" fill="#cbd5e1" font-family="sans-serif" font-size="11">Debug Panel</text>

  <!-- Row 2 -->
  <rect x="50" y="116" width="175" height="28" rx="14" fill="#1a2d50"/>
  <text x="137" y="135" text-anchor="middle" fill="#cbd5e1" font-family="sans-serif" font-size="11">Diff Viewer</text>
  <rect x="240" y="116" width="175" height="28" rx="14" fill="#1a2d50"/>
  <text x="327" y="135" text-anchor="middle" fill="#cbd5e1" font-family="sans-serif" font-size="11">Git Panel</text>
  <rect x="430" y="116" width="175" height="28" rx="14" fill="#1a2d50"/>
  <text x="517" y="135" text-anchor="middle" fill="#cbd5e1" font-family="sans-serif" font-size="11">LLM Agent Panel</text>
  <rect x="620" y="116" width="175" height="28" rx="14" fill="#1a2d50"/>
  <text x="707" y="135" text-anchor="middle" fill="#cbd5e1" font-family="sans-serif" font-size="11">Command Palette</text>

  <!-- Arrow 1 → 2 -->
  <line x1="430" y1="160" x2="430" y2="185" stroke="#334155" stroke-width="2"/>
  <polygon points="424,181 430,191 436,181" fill="#334155"/>

  <!-- ══════════ Layer 2: IDE Toolbox Protocol ══════════ -->
  <rect x="30" y="197" width="800" height="100" rx="8" fill="#0f2b2a" stroke="#22c55e" stroke-width="1"/>
  <text x="430" y="222" text-anchor="middle" fill="#f8fafc" font-family="sans-serif" font-size="15" font-weight="bold">IDE Toolbox Protocol</text>
  <text x="430" y="240" text-anchor="middle" fill="#4ade80" font-family="sans-serif" font-size="11">MCP-compatible tool interface</text>

  <rect x="50" y="254" width="115" height="28" rx="14" fill="#143330"/>
  <text x="107" y="273" text-anchor="middle" fill="#bbf7d0" font-family="sans-serif" font-size="10">ide.editor.*</text>
  <rect x="178" y="254" width="115" height="28" rx="14" fill="#143330"/>
  <text x="235" y="273" text-anchor="middle" fill="#bbf7d0" font-family="sans-serif" font-size="10">ide.debug.*</text>
  <rect x="306" y="254" width="115" height="28" rx="14" fill="#143330"/>
  <text x="363" y="273" text-anchor="middle" fill="#bbf7d0" font-family="sans-serif" font-size="10">ide.diff.*</text>
  <rect x="434" y="254" width="115" height="28" rx="14" fill="#143330"/>
  <text x="491" y="273" text-anchor="middle" fill="#bbf7d0" font-family="sans-serif" font-size="10">ide.git.*</text>
  <rect x="562" y="254" width="115" height="28" rx="14" fill="#143330"/>
  <text x="619" y="273" text-anchor="middle" fill="#bbf7d0" font-family="sans-serif" font-size="10">ide.test.*</text>
  <rect x="690" y="254" width="115" height="28" rx="14" fill="#143330"/>
  <text x="747" y="273" text-anchor="middle" fill="#bbf7d0" font-family="sans-serif" font-size="10">ide.terminal.*</text>

  <!-- Arrow 2 → 3 -->
  <line x1="430" y1="297" x2="430" y2="322" stroke="#334155" stroke-width="2"/>
  <polygon points="424,318 430,328 436,318" fill="#334155"/>

  <!-- ══════════ Layer 3: Core Services ══════════ -->
  <rect x="30" y="334" width="800" height="95" rx="8" fill="#1a1535" stroke="#8b5cf6" stroke-width="1"/>
  <text x="430" y="359" text-anchor="middle" fill="#f8fafc" font-family="sans-serif" font-size="15" font-weight="bold">Core Services</text>
  <text x="430" y="377" text-anchor="middle" fill="#a78bfa" font-family="sans-serif" font-size="11">Rust — async via tokio</text>

  <rect x="62" y="390" width="130" height="28" rx="14" fill="#251d45"/>
  <text x="127" y="409" text-anchor="middle" fill="#ddd6fe" font-family="sans-serif" font-size="11">LSP</text>
  <rect x="207" y="390" width="130" height="28" rx="14" fill="#251d45"/>
  <text x="272" y="409" text-anchor="middle" fill="#ddd6fe" font-family="sans-serif" font-size="11">DAP</text>
  <rect x="352" y="390" width="130" height="28" rx="14" fill="#251d45"/>
  <text x="417" y="409" text-anchor="middle" fill="#ddd6fe" font-family="sans-serif" font-size="11">Tree-sitter</text>
  <rect x="497" y="390" width="130" height="28" rx="14" fill="#251d45"/>
  <text x="562" y="409" text-anchor="middle" fill="#ddd6fe" font-family="sans-serif" font-size="11">Git</text>
  <rect x="642" y="390" width="130" height="28" rx="14" fill="#251d45"/>
  <text x="707" y="409" text-anchor="middle" fill="#ddd6fe" font-family="sans-serif" font-size="11">Keymap</text>

  <!-- Arrow 3 → 4 -->
  <line x1="430" y1="429" x2="430" y2="454" stroke="#334155" stroke-width="2"/>
  <polygon points="424,450 430,460 436,450" fill="#334155"/>

  <!-- ══════════ Layer 4: Extension Host Bridge ══════════ -->
  <rect x="30" y="466" width="800" height="118" rx="8" fill="#271a0a" stroke="#d45a3a" stroke-width="1"/>
  <text x="430" y="489" text-anchor="middle" fill="#f8fafc" font-family="sans-serif" font-size="15" font-weight="bold">Extension Host Bridge</text>
  <text x="430" y="507" text-anchor="middle" fill="#f0a070" font-family="sans-serif" font-size="11">Rust ↔ Node.js via JSON-RPC</text>

  <!-- Rust-side shim -->
  <rect x="50" y="520" width="340" height="32" rx="6" fill="#3a2210"/>
  <text x="220" y="541" text-anchor="middle" fill="#fde0c8" font-family="sans-serif" font-size="12" font-weight="bold">Rust-side Shim</text>

  <!-- Bidirectional arrow -->
  <line x1="400" y1="536" x2="460" y2="536" stroke="#d45a3a" stroke-width="2"/>
  <polygon points="456,532 466,536 456,540" fill="#d45a3a"/>
  <polygon points="404,532 394,536 404,540" fill="#d45a3a"/>

  <!-- JS-side shim -->
  <rect x="470" y="520" width="340" height="32" rx="6" fill="#3a2210"/>
  <text x="640" y="541" text-anchor="middle" fill="#fde0c8" font-family="sans-serif" font-size="12" font-weight="bold">JS-side VSCode API Shim</text>

  <!-- Extension pills -->
  <rect x="495" y="560" width="90" height="18" rx="9" fill="#2d1a0a"/>
  <text x="540" y="573" text-anchor="middle" fill="#f0a070" font-family="sans-serif" font-size="9">Extension 1</text>
  <rect x="595" y="560" width="90" height="18" rx="9" fill="#2d1a0a"/>
  <text x="640" y="573" text-anchor="middle" fill="#f0a070" font-family="sans-serif" font-size="9">Extension 2</text>
  <rect x="695" y="560" width="90" height="18" rx="9" fill="#2d1a0a"/>
  <text x="740" y="573" text-anchor="middle" fill="#f0a070" font-family="sans-serif" font-size="9">Extension N</text>
</svg>
