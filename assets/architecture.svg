<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 960 760">
  <!-- Background -->
  <rect width="960" height="760" rx="12" fill="#0a0f1a"/>

  <!-- ══════════ TMUX SESSION (dashed outer container) ══════════ -->
  <rect x="20" y="16" width="920" height="310" rx="10" fill="none" stroke="#475569" stroke-width="1.5" stroke-dasharray="6,4"/>
  <text x="40" y="35" fill="#64748b" font-family="monospace" font-size="11">tmux session (invisible to user)</text>

  <!-- ── Oxide TUI (tmux pane 1) ── -->
  <rect x="36" y="46" width="560" height="266" rx="8" fill="#111c33" stroke="#3b82f6" stroke-width="1"/>
  <text x="316" y="68" text-anchor="middle" fill="#f8fafc" font-family="sans-serif" font-size="14" font-weight="bold">Oxide TUI</text>
  <text x="316" y="84" text-anchor="middle" fill="#60a5fa" font-family="sans-serif" font-size="10">tmux pane 1 — ratatui + crossterm</text>

  <!-- File Tree -->
  <rect x="52" y="96" width="130" height="144" rx="6" fill="#1a2d50"/>
  <text x="117" y="115" text-anchor="middle" fill="#94a3b8" font-family="sans-serif" font-size="11" font-weight="bold">File Tree</text>
  <text x="72" y="134" fill="#475569" font-family="monospace" font-size="9">src/</text>
  <text x="80" y="148" fill="#475569" font-family="monospace" font-size="9">├── main.rs</text>
  <text x="80" y="162" fill="#475569" font-family="monospace" font-size="9">├── lib.rs</text>
  <text x="80" y="176" fill="#3b82f6" font-family="monospace" font-size="9">└── app.rs</text>
  <text x="72" y="196" fill="#475569" font-family="monospace" font-size="9">tests/</text>
  <text x="72" y="216" fill="#475569" font-family="monospace" font-size="9">Cargo.toml</text>

  <!-- Editor -->
  <rect x="194" y="96" width="388" height="144" rx="6" fill="#1a2d50"/>
  <text x="388" y="115" text-anchor="middle" fill="#94a3b8" font-family="sans-serif" font-size="11" font-weight="bold">Editor</text>
  <text x="388" y="136" text-anchor="middle" fill="#475569" font-family="sans-serif" font-size="10">diffs · highlights · breakpoints</text>

  <!-- Simulated code lines in editor -->
  <text x="214" y="160" fill="#8b5cf6" font-family="monospace" font-size="9">fn</text>
  <text x="232" y="160" fill="#60a5fa" font-family="monospace" font-size="9">main</text>
  <text x="264" y="160" fill="#64748b" font-family="monospace" font-size="9">() {</text>
  <text x="224" y="174" fill="#cbd5e1" font-family="monospace" font-size="9">let app = App::new();</text>
  <text x="224" y="188" fill="#cbd5e1" font-family="monospace" font-size="9">app.run()?;</text>
  <text x="214" y="202" fill="#64748b" font-family="monospace" font-size="9">}</text>

  <!-- Breakpoint dot -->
  <circle cx="206" cy="171" r="4" fill="#ef4444"/>

  <!-- Changed line highlight -->
  <rect x="194" y="180" width="4" height="14" fill="#22c55e" opacity="0.8"/>

  <!-- Tab bar + command palette -->
  <rect x="52" y="248" width="250" height="22" rx="4" fill="#1a2d50"/>
  <text x="68" y="263" fill="#94a3b8" font-family="sans-serif" font-size="9">Tab Bar</text>
  <rect x="314" y="248" width="268" height="22" rx="4" fill="#1a2d50"/>
  <text x="330" y="263" fill="#94a3b8" font-family="sans-serif" font-size="9">Command Palette</text>

  <!-- Status bar -->
  <rect x="52" y="278" width="530" height="24" rx="4" fill="#0f1729"/>
  <text x="68" y="294" fill="#64748b" font-family="monospace" font-size="10">main  Ln 4, Col 1  Rust  UTF-8</text>
  <text x="568" y="294" text-anchor="end" fill="#22c55e" font-family="monospace" font-size="10">MCP ●</text>

  <!-- ── MCP connection arrows between panes ── -->
  <line x1="608" y1="170" x2="638" y2="170" stroke="#22c55e" stroke-width="2"/>
  <polygon points="634,166 644,170 634,174" fill="#22c55e"/>
  <polygon points="612,166 602,170 612,174" fill="#22c55e"/>
  <text x="623" y="158" text-anchor="middle" fill="#4ade80" font-family="sans-serif" font-size="9" font-weight="bold">MCP</text>
  <text x="623" y="188" text-anchor="middle" fill="#334155" font-family="sans-serif" font-size="8">localhost:4322</text>

  <!-- ── Agent Pane (tmux pane 2) ── -->
  <rect x="650" y="46" width="274" height="266" rx="8" fill="#0d2420" stroke="#22c55e" stroke-width="1"/>
  <text x="787" y="68" text-anchor="middle" fill="#f8fafc" font-family="sans-serif" font-size="14" font-weight="bold">Agent Pane</text>
  <text x="787" y="84" text-anchor="middle" fill="#4ade80" font-family="sans-serif" font-size="10">tmux pane 2 — toggle Ctrl+L</text>

  <!-- Agent terminal content -->
  <text x="666" y="108" fill="#22c55e" font-family="monospace" font-size="10" font-weight="bold">$</text>
  <text x="680" y="108" fill="#4ade80" font-family="monospace" font-size="10">claude</text>
  <text x="666" y="130" fill="#cbd5e1" font-family="monospace" font-size="9">Claude> I'll fix that</text>
  <text x="666" y="144" fill="#cbd5e1" font-family="monospace" font-size="9">type error on line 4...</text>
  <text x="666" y="166" fill="#64748b" font-family="monospace" font-size="9">[tool] ide.diagnostics</text>
  <text x="666" y="180" fill="#64748b" font-family="monospace" font-size="9">       .list()</text>
  <text x="666" y="200" fill="#64748b" font-family="monospace" font-size="9">[tool] ide.editor</text>
  <text x="666" y="214" fill="#64748b" font-family="monospace" font-size="9">       .replaceRange()</text>
  <text x="666" y="236" fill="#22c55e" font-family="monospace" font-size="9">Fixed. The type error</text>
  <text x="666" y="250" fill="#22c55e" font-family="monospace" font-size="9">was a missing Result.</text>

  <!-- Agent pane status -->
  <rect x="666" y="278" width="80" height="20" rx="10" fill="#143330"/>
  <text x="706" y="292" text-anchor="middle" fill="#4ade80" font-family="sans-serif" font-size="9">Claude Code</text>
  <rect x="754" y="278" width="70" height="20" rx="10" fill="#143330"/>
  <text x="789" y="292" text-anchor="middle" fill="#4ade80" font-family="sans-serif" font-size="9">OpenCode</text>
  <rect x="832" y="278" width="56" height="20" rx="10" fill="#143330"/>
  <text x="860" y="292" text-anchor="middle" fill="#4ade80" font-family="sans-serif" font-size="9">Aider</text>

  <!-- ══════════ SEPARATOR ══════════ -->
  <line x1="60" y1="348" x2="400" y2="348" stroke="#1e293b" stroke-width="1"/>
  <text x="480" y="352" text-anchor="middle" fill="#64748b" font-family="sans-serif" font-size="12" font-style="italic">Underlying Architecture</text>
  <line x1="560" y1="348" x2="900" y2="348" stroke="#1e293b" stroke-width="1"/>

  <!-- Dashed lines connecting top to bottom -->
  <line x1="316" y1="312" x2="316" y2="376" stroke="#3b82f6" stroke-width="1.5" stroke-dasharray="4,3"/>
  <text x="300" y="350" text-anchor="end" fill="#60a5fa" font-family="sans-serif" font-size="9">renders state</text>

  <line x1="787" y1="312" x2="787" y2="376" stroke="#22c55e" stroke-width="1.5" stroke-dasharray="4,3"/>
  <text x="830" y="350" fill="#4ade80" font-family="sans-serif" font-size="9">MCP tools</text>

  <!-- ══════════ OXIDE CORE (source of truth) ══════════ -->
  <rect x="20" y="376" width="920" height="100" rx="8" fill="#1a1535" stroke="#8b5cf6" stroke-width="1"/>
  <text x="480" y="400" text-anchor="middle" fill="#f8fafc" font-family="sans-serif" font-size="15" font-weight="bold">Oxide Core</text>
  <text x="480" y="416" text-anchor="middle" fill="#a78bfa" font-family="sans-serif" font-size="11">Rust — async via tokio — source of truth for all IDE state</text>

  <!-- Service pills -->
  <rect x="48" y="430" width="120" height="28" rx="14" fill="#251d45"/>
  <text x="108" y="449" text-anchor="middle" fill="#ddd6fe" font-family="sans-serif" font-size="11">LSP</text>
  <rect x="182" y="430" width="120" height="28" rx="14" fill="#251d45"/>
  <text x="242" y="449" text-anchor="middle" fill="#ddd6fe" font-family="sans-serif" font-size="11">DAP</text>
  <rect x="316" y="430" width="120" height="28" rx="14" fill="#251d45"/>
  <text x="376" y="449" text-anchor="middle" fill="#ddd6fe" font-family="sans-serif" font-size="11">Tree-sitter</text>
  <rect x="450" y="430" width="120" height="28" rx="14" fill="#251d45"/>
  <text x="510" y="449" text-anchor="middle" fill="#ddd6fe" font-family="sans-serif" font-size="11">Git</text>
  <rect x="584" y="430" width="120" height="28" rx="14" fill="#251d45"/>
  <text x="644" y="449" text-anchor="middle" fill="#ddd6fe" font-family="sans-serif" font-size="11">Keymap</text>
  <rect x="718" y="430" width="120" height="28" rx="14" fill="#251d45"/>
  <text x="778" y="449" text-anchor="middle" fill="#ddd6fe" font-family="sans-serif" font-size="11">Config</text>

  <!-- Arrows from Core down to Extension Host and MCP Server -->
  <line x1="260" y1="476" x2="260" y2="508" stroke="#334155" stroke-width="2"/>
  <polygon points="254,504 260,514 266,504" fill="#334155"/>
  <line x1="700" y1="476" x2="700" y2="508" stroke="#334155" stroke-width="2"/>
  <polygon points="694,504 700,514 706,504" fill="#334155"/>

  <!-- ══════════ EXTENSION HOST BRIDGE (left) ══════════ -->
  <rect x="20" y="520" width="440" height="136" rx="8" fill="#271a0a" stroke="#d45a3a" stroke-width="1"/>
  <text x="240" y="543" text-anchor="middle" fill="#f8fafc" font-family="sans-serif" font-size="14" font-weight="bold">Extension Host Bridge</text>
  <text x="240" y="559" text-anchor="middle" fill="#f0a070" font-family="sans-serif" font-size="10">Rust ↔ Node.js — JSON-RPC over Unix sockets</text>

  <!-- Rust-side shim -->
  <rect x="36" y="572" width="190" height="30" rx="6" fill="#3a2210"/>
  <text x="131" y="591" text-anchor="middle" fill="#fde0c8" font-family="sans-serif" font-size="11" font-weight="bold">Rust-side Shim</text>

  <!-- Bidirectional arrow -->
  <line x1="236" y1="587" x2="270" y2="587" stroke="#d45a3a" stroke-width="2"/>
  <polygon points="266,583 276,587 266,591" fill="#d45a3a"/>
  <polygon points="240,583 230,587 240,591" fill="#d45a3a"/>

  <!-- JS-side shim -->
  <rect x="280" y="572" width="164" height="30" rx="6" fill="#3a2210"/>
  <text x="362" y="591" text-anchor="middle" fill="#fde0c8" font-family="sans-serif" font-size="11" font-weight="bold">JS VSCode Shim</text>

  <!-- Extension pills -->
  <rect x="280" y="612" width="70" height="18" rx="9" fill="#2d1a0a"/>
  <text x="315" y="625" text-anchor="middle" fill="#f0a070" font-family="sans-serif" font-size="9">Ext 1</text>
  <rect x="358" y="612" width="70" height="18" rx="9" fill="#2d1a0a"/>
  <text x="393" y="625" text-anchor="middle" fill="#f0a070" font-family="sans-serif" font-size="9">Ext N</text>
  <text x="240" y="648" text-anchor="middle" fill="#64748b" font-family="sans-serif" font-size="9">Node.js process (isolated)</text>

  <!-- ══════════ MCP SERVER (right) ══════════ -->
  <rect x="500" y="520" width="440" height="136" rx="8" fill="#0d2420" stroke="#22c55e" stroke-width="1"/>
  <text x="720" y="543" text-anchor="middle" fill="#f8fafc" font-family="sans-serif" font-size="14" font-weight="bold">MCP Server</text>
  <text x="720" y="559" text-anchor="middle" fill="#4ade80" font-family="sans-serif" font-size="10">HTTP + SSE — localhost:4322 — default on</text>

  <!-- Tools -->
  <rect x="516" y="572" width="196" height="30" rx="6" fill="#143330"/>
  <text x="614" y="591" text-anchor="middle" fill="#bbf7d0" font-family="sans-serif" font-size="11" font-weight="bold">↕ Tools (MCP)</text>

  <!-- Events -->
  <rect x="728" y="572" width="196" height="30" rx="6" fill="#143330"/>
  <text x="826" y="591" text-anchor="middle" fill="#bbf7d0" font-family="sans-serif" font-size="11" font-weight="bold">↓ Events (SSE)</text>

  <!-- External agents label -->
  <text x="720" y="620" text-anchor="middle" fill="#64748b" font-family="sans-serif" font-size="9">Any MCP client connects:</text>

  <!-- Agent pills -->
  <rect x="556" y="628" width="94" height="18" rx="9" fill="#143330"/>
  <text x="603" y="641" text-anchor="middle" fill="#4ade80" font-family="sans-serif" font-size="9">Claude Code</text>
  <rect x="660" y="628" width="80" height="18" rx="9" fill="#143330"/>
  <text x="700" y="641" text-anchor="middle" fill="#4ade80" font-family="sans-serif" font-size="9">OpenCode</text>
  <rect x="750" y="628" width="60" height="18" rx="9" fill="#143330"/>
  <text x="780" y="641" text-anchor="middle" fill="#4ade80" font-family="sans-serif" font-size="9">Aider</text>
  <rect x="820" y="628" width="94" height="18" rx="9" fill="#143330"/>
  <text x="867" y="641" text-anchor="middle" fill="#4ade80" font-family="sans-serif" font-size="9">curl / any</text>

  <!-- ══════════ BOTTOM: .mcp.json config ══════════ -->
  <rect x="220" y="688" width="520" height="52" rx="8" fill="#111827" stroke="#334155" stroke-width="1"/>
  <text x="480" y="710" text-anchor="middle" fill="#64748b" font-family="monospace" font-size="10">.mcp.json → { "oxide": { "url": "http://localhost:4322/mcp" } }</text>
  <text x="480" y="728" text-anchor="middle" fill="#475569" font-family="sans-serif" font-size="9">Zero config — any MCP client connects with one line</text>
</svg>
